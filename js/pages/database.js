jQuery&&function(t){var e=[{name:"楼层1",width:1520,height:517,src:"image/img_01.svg"},{name:"楼层2",width:1520,height:467,src:"image/img_02.svg"},{name:"楼层3",width:1520,height:374,src:"image/img_03.svg"},{name:"楼层4",width:1520,height:355,src:"image/img_04.svg"},{name:"楼层5",width:1520,height:307,src:"image/img_05.svg"}];window.WebDatabase={getFloors:function(t){this.DB.transaction(function(e){e.executeSql("select rowid as id, FloorName as name, width as w, height as h, srcUrl as url from Floors",[],function(e,n){if("function"==typeof t){for(var o=[],i=0;i<n.rows.length;i++)o[o.length]=n.rows[i];t(o)}})})},getNodeById:function(t,e){this.DB.transaction(function(n){n.executeSql("SELECT rowid as id, name, floorId as fId, number, x, y, iconName from Nodes WHERE floorId = ?",[t],function(t,n){if("function"==typeof e){for(var o=[],i=0;i<n.rows.length;i++)o[o.length]=n.rows[i];e(o)}},function(t,n){e([])})})},insertNodeById:function(t,e,n,o,i,r,s,l){this.DB.transaction(function(a){a.executeSql("insert into Nodes(name, floorId, number, x, y, iconName) values(?,?,?,?,?,?)",[t,e,n,o,i,r],function(t,e){t.executeSql("SELECT max(rowid) as id from Nodes",[],function(t,e){e.rows.length>0&&"function"==typeof s&&s(e.rows[0].id)},function(t,e){"function"==typeof l&&l(e)})},function(t,e){})})},editNodeById:function(e,n,o,i,r,s,l){var a=[],c="update Nodes SET ";"string"==typeof e&&""!=t.trim(e)&&(a[a.length]={name:e}),"number"==typeof n&&(a[a.length]={floorId:n}),"string"==typeof o&&""!=t.trim(o)&&(a[a.length]={number:o}),"number"==typeof i&&(a[a.length]={x:i}),"number"==typeof r&&(a[a.length]={y:r}),"string"==typeof s&&""!=t.trim(s)&&(a[a.length]={iconName:s});for(var u=0;u<a.length;u++)0==u?t.each(a[u],function(t,e){c+=t+" = "+("string"==typeof e?'"'+e+'"':e)}):t.each(a[u],function(t,e){c+=","+t+" = "+("string"==typeof e?'"'+e+'"':e)});c+=" WHERE rowid = "+l,console.log(c),this.DB.transaction(function(t){t.executeSql(c,[],function(t,e){console.log("result",e)},function(t,e){console.log("message",e)})})},deleteNodeById:function(t){this.DB.transaction(function(e){e.executeSql("DELETE FROM Nodes WHERE rowid = ?",[t],function(t,e){},function(t,e){})})}},t(function(){!function(){var t=openDatabase("myDb","1.0","it's to save demo data!",1048576);if(!t)return alert("您的浏览器不支持HTML5本地数据库"),!1;window.WebDatabase.DB=t,t.transaction(function(t){t.executeSql("create table if not exists Nodes(name text null, floorId int null, number text null, x int null, y int null, iconName text null)"),t.executeSql("create table if not exists Floors(FloorName text null, width text null, height text null, srcUrl text null)"),t.executeSql("select * from Floors",[],function(t,n){if(0==n.rows.length)for(var o,i=0;i<e.length;i++)o=e[i],t.executeSql("insert into Floors(FloorName, width, height, srcUrl) values(?,?,?,?)",[o.name,o.width,o.height,o.src],function(t,e){},function(t,e){})})},function(t,e){},function(t,e){})}()})}(jQuery);